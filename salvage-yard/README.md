Some of this code may be salvageable 
